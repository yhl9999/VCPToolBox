{
  "manifestVersion": "1.0.0",
  "name": "IMAPIndex",
  "version": "1.0.0",
  "displayName": "IMAP 邮件本地索引插件",
  "description": "静态插件：定期通过 IMAP 拉取白名单匹配邮件到本地（.eml -> .md 转换），合并生成索引文本并输出到 stdout，供占位符注入系统提示词使用。仅邮件链路支持 HTTP(S) CONNECT 代理（可选）。",
  "author": "B3000Kcn",
  "pluginType": "static",
  "entryPoint": {
    "command": "node IMAPIndex.js"
  },
  "communication": {
    "protocol": "stdio",
    "timeout": 600000
  },
  "capabilities": {
    "systemPromptPlaceholders": [
      {
        "placeholder": "{{IMAPIndex}}",
        "description": "包含所有本地存储邮件（Markdown）的整合索引文本。插件运行时会输出该索引的完整内容；VCP 主服务可按计划刷新以更新占位符内容。"
      }
    ],
    "invocationCommands": []
  },
  "refreshIntervalCron": "*/30 * * * *",
  "configSchema": {
    "IMAP_USER": {
      "type": "string",
      "description": "IMAP 登录用户名（邮箱地址）。",
      "default": "",
      "required": true
    },
    "IMAP_PASS": {
      "type": "string",
      "description": "IMAP 登录密码或应用专用密码。",
      "default": "",
      "required": true
    },
    "IMAP_HOST": {
      "type": "string",
      "description": "IMAP 服务器主机名（如 imap.qq.com）。",
      "default": "imap.example.com",
      "required": true
    },
    "IMAP_PORT": {
      "type": "number",
      "description": "IMAP 端口，隐式 TLS 通常为 993。",
      "default": 993,
      "required": true
    },
    "IMAP_TLS": {
      "type": "boolean",
      "description": "是否启用 TLS（隐式 TLS 端口 993）。",
      "default": true,
      "required": true
    },
    "TIME_LIMIT_DAYS": {
      "type": "number",
      "description": "仅搜索最近 N 天内的邮件（IMAP 搜索条件 SINCE）。",
      "default": 3,
      "required": false
    },
    "STORAGE_PATH": {
      "type": "string",
      "description": "本地存储目录（用于保存 .eml 与 .md 及 vcp_index.md）。",
      "default": "./mail_store",
      "required": false
    },
    "WHITELIST": {
      "type": "string",
      "description": "发件人白名单，逗号分隔（例如 alice@example.com,bob@example.com）。为空则跳过拉取。",
      "default": "",
      "required": false
    },
    "IMAP_PROXY_ENABLED": {
      "type": "boolean",
      "description": "是否启用 IMAP 链路代理（仅邮件链路走代理）。",
      "default": false,
      "required": false
    },
    "IMAP_PROXY_URL": {
      "type": "string",
      "description": "HTTP(S) 前置代理 URL（可含 basic 认证）。例如：http://127.0.0.1:7890 或 https://user:pass@proxy.example.com:8443",
      "default": "",
      "required": false
    },
    "IMAP_PROXY_TIMEOUT_MS": {
      "type": "number",
      "description": "建立代理隧道与 TLS 握手的超时（毫秒）。",
      "default": 10000,
      "required": false
    },
    "IMAP_PROXY_TLS_REJECT_UNAUTHORIZED": {
      "type": "boolean",
      "description": "是否校验目标 IMAP 服务器证书（true 为严格校验，自签名可设为 false）。",
      "default": true,
      "required": false
    },
    "DebugMode": {
      "type": "boolean",
      "description": "启用额外调试日志（stderr）。",
      "default": false,
      "required": false
    }
  }
}